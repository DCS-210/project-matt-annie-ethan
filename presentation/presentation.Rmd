---
title: "Exoplanet Exploration"
subtitle: "Examining Driving Factors in Exoplanet Exploration"
author: "Annie Li, Matt Clayton, Ethan Wu"
institute: "Bates College"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

### Research Questions

General Research Question:

#### What are the main driving factors in exoplanet discovery, and how can these factors influence the future of exoplanet exploration?

Sub-questions:

- How has the number of discovered exoplanets changed over time (in relation to the type of discovery method, discovery facility and distance from earth)?

- How does the number of discoveries vary across countries and how does the result relate to the country’s gdp?


---

```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
library(xaringan)
library(dplyr)
library(maps)
library(ggplot2)
library(gganimate)
library(gifski)
library(leaflet) 
library(sf) 
library(RColorBrewer) 
library(htmltools) 
library(leafsync)
```

```{r setup, include = FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r load-data, include = FALSE}
alldata <- read_csv("/cloud/project/data/filtereddata.csv")
alldataunfiltered <- read_csv("/cloud/project/data/unfiltereddata.csv")
```

```{r discovery-facility-country, include = FALSE}
# Create new variable for country of discovery facility

### Facility Country for filtered data

alldata %>%
  count(disc_facility, sort = TRUE)

alldata <- alldata %>%
  
  mutate(disc_facility = as.character(disc_facility),
         disc_facility_country = case_when(
                                 disc_facility %in% c("Kepler",
                                                       "K2",
                                                       "Transiting Exoplanet Survey Satellite (TESS)",
                                                       "HATNet",
                                                       "HATSouth",
                                                       "W. M. Keck Observatory",
                                                       "XO",
                                                       "KELT-North",
                                                       "KELT",
                                                       "TrES",
                                                       "Acton Sky Portal Observatory",
                                                       "Gemini Observatory",
                                                       "KELT-South",
                                                       "Las Campanas Observatory",
                                                       "MEarth Project",
                                                       "Cerro Tololo Inter-American Observatory",
                                                       "Fred Lawrence Whipple Observatory",
                                                       "Lick Observatory",
                                                       "McDonald Observatory")
                                                        ~ "United States",
                                 disc_facility %in% c("La Silla Observatory",
                                                       "Paranal Observatory",
                                                       "CoRoT")
                                                        ~ "Europe",
                                 disc_facility %in% c("SuperWASP",
                                                       "WASP-South",
                                                       "SuperWASP-North",
                                                       "SuperWASP-South",
                                                       "United Kingdom Infrared Telescope")
                                                       ~ "United Kingdom",
                                 disc_facility %in% c("Roque de los Muchachos Observatory",
                                                       "Calar Alto Observatory")
                                                       ~ "Spain",
                                 disc_facility == "Haute-Provence Observatory" ~ "France",
                                 disc_facility == "Qatar" ~ "Qatar",
                                 disc_facility == "OGLE" ~ "Poland",
                                 disc_facility == "Subaru Telescope" ~ "Japan",
                                 TRUE ~ disc_facility
  )) 

### Facility Country for unfiltered data

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         disc_facility_country = case_when(
                                 disc_facility %in% c("Kepler",
                                                       "K2",
                                                       "Transiting Exoplanet Survey Satellite (TESS)",
                                                       "HATNet",
                                                       "HATSouth",
                                                       "W. M. Keck Observatory",
                                                       "XO",
                                                       "KELT-North",
                                                       "KELT",
                                                       "TrES",
                                                       "Acton Sky Portal Observatory",
                                                       "Gemini Observatory",
                                                       "KELT-South",
                                                       "Las Campanas Observatory",
                                                       "MEarth Project",
                                                       "Cerro Tololo Inter-American Observatory",
                                                       "Fred Lawrence Whipple Observatory",
                                                       "Lick Observatory",
                                                       "McDonald Observatory",
                                                       "Hubble Space Telescope",
                                                       "NASA Infrared Telescope Facility (IRTF)",
                                                       "Spitzer Space Telescope",
                                                       "Palomar Observatory",
                                                       "Kitt Peak National Observatory",
                                                       "Oak Ridge Observatory",
                                                       "Apache Point Observatory",
                                                       "Large Binocular Telescope Observatory",
                                                       "Winer Observatory",
                                                       "Arecibo Observatory",
                                                       "Leoncito Astronomical Complex",
                                                       "Mauna Kea Observatory",
                                                       "Haleakala Observatory")
                                                        ~ "United States",
                                 disc_facility %in% c("La Silla Observatory",
                                                       "Paranal Observatory",
                                                       "CoRoT",
                                                       "CHaracterising ExOPlanets Satellite (CHEOPS)",
                                                       "Atacama Large Millimeter Array (ALMA)",
                                                       "European Southern Observatory")
                                                        ~ "Europe",
                                 disc_facility %in% c("SuperWASP",
                                                       "WASP-South",
                                                       "SuperWASP-North",
                                                       "SuperWASP-South",
                                                       "United Kingdom Infrared Telescope",
                                                       "Infrared Survey Facility")
                                                       ~ "United Kingdom",
                                 disc_facility %in% c("Roque de los Muchachos Observatory",
                                                       "Calar Alto Observatory",
                                                       "Teide Observatory")
                                                       ~ "Spain",
                                 disc_facility %in% c("Xinglong Station", 
                                                      "Yunnan Astronomical Observatory")
                                                      ~ "China",
                                 disc_facility %in% c("Subaru Telescope",
                                                      "Okayama Astrophysical Observatory")
                                                      ~ "Japan",
                                 disc_facility %in% c("Anglo-Australian Telescope",
                                                      "Parkes Observatory")
                                                      ~ "Australia",
                                 disc_facility %in% c("KMTNet",
                                                      "Bohyunsan Optical Astronomical Observatory")
                                                      ~ "South Korea",
                                 disc_facility == "MOA" ~ "New Zealand",
                                 disc_facility == "Haute-Provence Observatory" ~ "France",
                                 disc_facility == "Qatar" ~ "Qatar",
                                 disc_facility == "OGLE" ~ "Poland",
                                 disc_facility == "Thueringer Landessternwarte Tautenburg" ~ "Germany",
                                 
                                 TRUE ~ disc_facility
  ))

```

```{r public-or-private, include = FALSE}

### Public or private for filtered data

alldata <- alldata %>%
  
  mutate(disc_facility = as.character(disc_facility),
         public_or_private = ifelse( disc_facility %in% c("KELT-North",
                                                          "KELT",
                                                          "Fred Lawrence Whipple Observatory",
                                                          "McDonald Observatory",
                                                          "Acton Sky Portal Observatory",
                                                          "KELT-South"), "Private", "Public"))

### Public or private for unfiltered data

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         public_or_private = ifelse( disc_facility %in% c("KELT-North",
                                                          "KELT",
                                                          "Fred Lawrence Whipple Observatory",
                                                          "McDonald Observatory",
                                                          "Acton Sky Portal Observatory",
                                                          "KELT-South",
                                                          "Palomar Observatory",
                                                          "Oak Ridge Observatory",
                                                          "KMTNet",
                                                          "Large Binocular Telescope Observatory",
                                                          "Winer Observatory"), "Private", "Public"))
```

```{r telescope-type, include = FALSE}

### Facility Type for filtered data

alldata <- alldata %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_type = ifelse( disc_facility %in% c("CoRoT",
                                                      "Kepler",
                                                      "K2",
                                                      "Transiting Exoplanet Survey Satellite (TESS)"),
                                                         "Space Telescope",
                                                         "Observatory"))
  
### Facility Type for unfiltered data

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_type = ifelse( disc_facility %in% c("CoRoT",
                                                      "Kepler",
                                                      "K2",
                                                      "Transiting Exoplanet Survey Satellite (TESS)",
                                                      "Hubble Space Telescope",
                                                      "Spitzer Space Telescope",
                                                      "CHaracterising ExOPlanets Satellite (CHEOPS)"),
                                                         "Space Telescope",
                                                         "Observatory"))
```

```{r facility-latitude, include = FALSE}

### Latitude for filtered data

alldata <- alldata %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_latitude = case_when(
                                 disc_facility == "HATNet" ~ 31.674920,
                                 disc_facility == "HATSouth" ~ -29.014600,
                                 disc_facility == "W. M. Keck Observatory" ~ 19.826360,
                                 disc_facility == "XO" ~ 20.708300,
                                 disc_facility == "TrES" ~ 35.1210,
                                 disc_facility == "Gemini Observatory" ~ 19.823960,
                                 disc_facility == "Las Campanas Observatory" ~ -29.014600,
                                 disc_facility == "MEarth Project" ~ 31.674920,
                                 disc_facility == "Cerro Tololo Inter-American Observatory" ~ -30.169660,
                                 disc_facility == "Lick Observatory" ~ 37.341373,
                                 disc_facility == "La Silla Observatory" ~ -29.261170,
                                 disc_facility == "Paranal Observatory" ~ -24.627220,
                                 disc_facility == "SuperWASP" ~ 28.4537,
                                 disc_facility == "WASP-South" ~ -26.030260,
                                 disc_facility == "SuperWASP-North" ~ 28.75651,
                                 disc_facility == "SuperWASP-South" ~ -26.030260,
                                 disc_facility == "United Kingdom Infrared Telescope" ~ 19.822500,
                                 disc_facility == "Roque de los Muchachos Observatory" ~ 28.4522,
                                 disc_facility == "Calar Alto Observatory" ~ 37.220790,
                                 disc_facility == "Haute-Provence Observatory" ~ 43.930830, 
                                 disc_facility == "Qatar" ~ 32.902359,
                                 disc_facility == "OGLE" ~ -29.0036,
                                 disc_facility == "Subaru Telescope" ~ 19.701610,
                                 disc_facility == "KELT-North" ~ 31.71272,
                                 disc_facility == "KELT" ~ 31.71272,
                                 disc_facility == "Fred Lawrence Whipple Observatory" ~ 31.674920,
                                 disc_facility == "McDonald Observatory" ~ 30.679770,
                                 disc_facility == "Acton Sky Portal Observatory" ~ 42.477587,
                                 disc_facility == "KELT-South" ~ 31.71272,
                                 disc_facility == "CoRoT" ~ 45.592759,
                                 disc_facility == "Kepler" ~ 28.446671,
                                 disc_facility == "K2" ~ 28.446671,
                                 disc_facility == "Transiting Exoplanet Survey Satellite (TESS)" ~ 28.562110,
                                 
                                                     
                                 TRUE ~ 0
  ))

### Latitude for unfiltered data

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_latitude = case_when(
                                 disc_facility == "HATNet" ~ 31.674920,
                                 disc_facility == "HATSouth" ~ -29.014600,
                                 disc_facility == "W. M. Keck Observatory" ~ 19.826360,
                                 disc_facility == "XO" ~ 20.708300,
                                 disc_facility == "TrES" ~ 35.1210,
                                 disc_facility == "Gemini Observatory" ~ 19.823960,
                                 disc_facility == "Las Campanas Observatory" ~ -29.014600,
                                 disc_facility == "MEarth Project" ~ 31.674920,
                                 disc_facility == "Cerro Tololo Inter-American Observatory" ~ -30.169660,
                                 disc_facility == "Lick Observatory" ~ 37.341373,
                                 disc_facility == "La Silla Observatory" ~ -29.261170,
                                 disc_facility == "Paranal Observatory" ~ -24.627220,
                                 disc_facility == "SuperWASP" ~ 28.4537,
                                 disc_facility == "WASP-South" ~ -26.030260,
                                 disc_facility == "SuperWASP-North" ~ 28.75651,
                                 disc_facility == "SuperWASP-South" ~ -26.030260,
                                 disc_facility == "United Kingdom Infrared Telescope" ~ 19.822500,
                                 disc_facility == "Roque de los Muchachos Observatory" ~ 28.4522,
                                 disc_facility == "Calar Alto Observatory" ~ 37.220790,
                                 disc_facility == "Haute-Provence Observatory" ~ 43.930830, 
                                 disc_facility == "Qatar" ~ 32.902359,
                                 disc_facility == "OGLE" ~ -29.0036,
                                 disc_facility == "Subaru Telescope" ~ 19.701610,
                                 disc_facility == "KELT-North" ~ 31.71272,
                                 disc_facility == "KELT" ~ 31.71272,
                                 disc_facility == "Fred Lawrence Whipple Observatory" ~ 31.674920,
                                 disc_facility == "McDonald Observatory" ~ 30.679770,
                                 disc_facility == "Acton Sky Portal Observatory" ~ 42.477587,
                                 disc_facility == "KELT-South" ~ 31.71272,
                                 disc_facility == "CoRoT" ~ 45.592759,
                                 disc_facility == "Kepler" ~ 28.446671,
                                 disc_facility == "K2" ~ 28.446671,
                                 disc_facility == "Transiting Exoplanet Survey Satellite (TESS)" ~ 28.562110,
                                 disc_facility == "Xinglong Station" ~ 40.394170,
                                 disc_facility == "Thueringer Landessternwarte Tautenburg" ~ 50.982190,
                                 disc_facility == "Okayama Astrophysical Observatory" ~ 34.576100,
                                 disc_facility == "Hubble Space Telescope" ~ 28.608400,
                                 disc_facility == "Anglo-Australian Telescope" ~ -31.275400,
                                 disc_facility == "Bohyunsan Optical Astronomical Observatory" ~ 36.160774,
                                 disc_facility == "NASA Infrared Telescope Facility (IRTF)" ~ 19.826210,
                                 disc_facility == "Yunnan Astronomical Observatory" ~ 25.033330, 
                                 disc_facility == "Spitzer Space Telescope" ~ 28.446671,
                                 disc_facility == "Kitt Peak National Observatory" ~ 31.960050,
                                 disc_facility == "CHaracterising ExOPlanets Satellite (CHEOPS)" ~ 5.301861,
                                 disc_facility == "Apache Point Observatory" ~ 32.780340,
                                 disc_facility == "Atacama Large Millimeter Array (ALMA)" ~ -23.027780,
                                 disc_facility == "MOA" ~ -43.970600,
                                 disc_facility == "European Southern Observatory" ~ 48.260000,
                                 disc_facility == "Arecibo Observatory" ~ 18.344168,
                                 disc_facility == "Parkes Observatory" ~ -33.011640,
                                 disc_facility == "Leoncito Astronomical Complex" ~ -31.798600,
                                 disc_facility == "Infrared Survey Facility" ~ 19.822500,
                                 disc_facility == "Mauna Kea Observatory" ~ 19.4920,
                                 disc_facility == "Teide Observatory" ~ 28.1800,
                                 disc_facility == "Haleakala Observatory" ~ 20.4230,
                                 disc_facility == "Palomar Observatory" ~ 33.357030,
                                 disc_facility == "Oak Ridge Observatory" ~ 42.505000,
                                 disc_facility == "KMTNet" ~ -31.16163,
                                 disc_facility == "Large Binocular Telescope Observatory" ~ 32.701310,
                                 disc_facility == "Winer Observatory" ~ 31.665947,
                                 
                                 TRUE ~ 0
  ))

```

```{r facility-longitude, include = FALSE}

### Longitude for filtered data

alldata <- alldata %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_longitude = case_when(
                                 disc_facility == "HATNet" ~ -110.949600,
                                 disc_facility == "HATSouth" ~ -70.692600,
                                 disc_facility == "W. M. Keck Observatory" ~ -155.475000,
                                 disc_facility == "XO" ~ -156.257100,
                                 disc_facility == "TrES" ~ -111.3952,
                                 disc_facility == "Gemini Observatory" ~ -155.469800,
                                 disc_facility == "Las Campanas Observatory" ~ -70.692600,
                                 disc_facility == "MEarth Project" ~ -110.949600,
                                 disc_facility == "Cerro Tololo Inter-American Observatory" ~ -70.806530,
                                 disc_facility == "Lick Observatory" ~ -121.642944,
                                 disc_facility == "La Silla Observatory" ~ -70.731330,
                                 disc_facility == "Paranal Observatory" ~ -70.404170,
                                 disc_facility == "SuperWASP" ~ -17.5245,
                                 disc_facility == "WASP-South" ~ 27.924900,
                                 disc_facility == "SuperWASP-North" ~ -17.89163,
                                 disc_facility == "SuperWASP-South" ~ 27.924900,
                                 disc_facility == "United Kingdom Infrared Telescope" ~ -155.470700,
                                 disc_facility == "Roque de los Muchachos Observatory" ~ -17.5330,
                                 disc_facility == "Calar Alto Observatory" ~ -2.546575,
                                 disc_facility == "Haute-Provence Observatory" ~ 5.713333, 
                                 disc_facility == "Qatar" ~ -105.530205,
                                 disc_facility == "OGLE" ~ -70.4156,
                                 disc_facility == "Subaru Telescope" ~ -155.089600,
                                 disc_facility == "KELT-North" ~ -110.60182,
                                 disc_facility == "KELT" ~ -110.60182,
                                 disc_facility == "Fred Lawrence Whipple Observatory" ~ -110.949600,
                                 disc_facility == "McDonald Observatory" ~ -104.024800,
                                 disc_facility == "Acton Sky Portal Observatory" ~ -71.453447,
                                 disc_facility == "KELT-South" ~ -110.60182,
                                 disc_facility == "CoRoT" ~ 63.333059,
                                 disc_facility == "Kepler" ~ -80.566109,
                                 disc_facility == "K2" ~ -80.566109,
                                 disc_facility == "Transiting Exoplanet Survey Satellite (TESS)" ~ -80.577180,
                                                     
                                 TRUE ~ 0
  ))

### Longitude for unfiltered data

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_longitude = case_when(
                                 disc_facility == "HATNet" ~ -110.949600,
                                 disc_facility == "HATSouth" ~ -70.692600,
                                 disc_facility == "W. M. Keck Observatory" ~ -155.475000,
                                 disc_facility == "XO" ~ -156.257100,
                                 disc_facility == "TrES" ~ -111.3952,
                                 disc_facility == "Gemini Observatory" ~ -155.469800,
                                 disc_facility == "Las Campanas Observatory" ~ -70.692600,
                                 disc_facility == "MEarth Project" ~ -110.949600,
                                 disc_facility == "Cerro Tololo Inter-American Observatory" ~ -70.806530,
                                 disc_facility == "Lick Observatory" ~ -121.642944,
                                 disc_facility == "La Silla Observatory" ~ -70.731330,
                                 disc_facility == "Paranal Observatory" ~ -70.404170,
                                 disc_facility == "SuperWASP" ~ -17.5245,
                                 disc_facility == "WASP-South" ~ 27.924900,
                                 disc_facility == "SuperWASP-North" ~ -17.89163,
                                 disc_facility == "SuperWASP-South" ~ 27.924900,
                                 disc_facility == "United Kingdom Infrared Telescope" ~ -155.470700,
                                 disc_facility == "Roque de los Muchachos Observatory" ~ -17.5330,
                                 disc_facility == "Calar Alto Observatory" ~ -2.546575,
                                 disc_facility == "Haute-Provence Observatory" ~ 5.713333, 
                                 disc_facility == "Qatar" ~ -105.530205,
                                 disc_facility == "OGLE" ~ -70.4156,
                                 disc_facility == "Subaru Telescope" ~ -155.089600,
                                 disc_facility == "KELT-North" ~ -110.60182,
                                 disc_facility == "KELT" ~ -110.60182,
                                 disc_facility == "Fred Lawrence Whipple Observatory" ~ -110.949600,
                                 disc_facility == "McDonald Observatory" ~ -104.024800,
                                 disc_facility == "Acton Sky Portal Observatory" ~ -71.453447,
                                 disc_facility == "KELT-South" ~ -110.60182,
                                 disc_facility == "CoRoT" ~ 63.333059,
                                 disc_facility == "Kepler" ~ -80.566109,
                                 disc_facility == "K2" ~ -80.566109,
                                 disc_facility == "Transiting Exoplanet Survey Satellite (TESS)" ~ -80.577180, 
                                 disc_facility == "Xinglong Station" ~ 117.575000,
                                 disc_facility == "Thueringer Landessternwarte Tautenburg" ~ 11.710900,
                                 disc_facility == "Okayama Astrophysical Observatory" ~ 133.594000,
                                 disc_facility == "Hubble Space Telescope" ~ -80.604350,
                                 disc_facility == "Anglo-Australian Telescope" ~ 149.067200,
                                 disc_facility == "Bohyunsan Optical Astronomical Observatory" ~ 128.973770,
                                 disc_facility == "NASA Infrared Telescope Facility (IRTF)" ~ -155.472600,
                                 disc_facility == "Yunnan Astronomical Observatory" ~ 102.783300, 
                                 disc_facility == "Spitzer Space Telescope" ~ -80.566109,
                                 disc_facility == "Kitt Peak National Observatory" ~ -111.598000,
                                 disc_facility == "CHaracterising ExOPlanets Satellite (CHEOPS)" ~ -52.834583,
                                 disc_facility == "Apache Point Observatory" ~ -105.819800,
                                 disc_facility == "Atacama Large Millimeter Array (ALMA)" ~ -67.754810,
                                 disc_facility == "MOA" ~ 170.467133,
                                 disc_facility == "European Southern Observatory" ~ 11.671110,
                                 disc_facility == "Arecibo Observatory" ~ -66.752777,
                                 disc_facility == "Parkes Observatory" ~ 148.258200,
                                 disc_facility == "Leoncito Astronomical Complex" ~ -69.295600,
                                 disc_facility == "Infrared Survey Facility" ~ -155.470700,
                                 disc_facility == "Mauna Kea Observatory" ~ -155.2830,
                                 disc_facility == "Teide Observatory" ~ -16.3035,
                                 disc_facility == "Haleakala Observatory" ~ -156.1526,
                                 disc_facility == "Palomar Observatory" ~ -116.865300,
                                 disc_facility == "Oak Ridge Observatory" ~ -71.558000,
                                 disc_facility == "KMTNet" ~ 149.03452,
                                 disc_facility == "Large Binocular Telescope Observatory" ~ -109.889100,
                                 disc_facility == "Winer Observatory" ~ -110.602058,
                                 
                                 TRUE ~ 0
  ))

```

```{r facility-country-gdp, include = FALSE}

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         GDP_2020 = case_when(
                                 disc_facility_country == "United States" ~ 63543.58,
                                 disc_facility_country == "Europe" ~ 34114.9,
                                 disc_facility_country == "United Kingdom" ~ 40284.64,
                                 disc_facility_country == "Spain" ~ 27063.19,
                                 disc_facility_country == "China" ~ 10500.40,
                                 disc_facility_country == "Japan" ~ 39538.88,
                                 disc_facility_country == "Australia" ~ 51812.15,
                                 disc_facility_country == "South Korea" ~ 31489.12,
                                 disc_facility_country == "New Zealand" ~ 41477.94,
                                 disc_facility_country == "France" ~ 39030.36,
                                 disc_facility_country == "Qatar" ~ 50805.46,
                                 disc_facility_country == "Poland" ~ 15656.18,
                                 disc_facility_country == "Germany" ~ 46208.43,
                                 
                                 TRUE ~ 0
  ))

```


```{r title-slide-background, include = FALSE}
style_xaringan(
  title_slide_background_image = "img/SPACE_2.jpg"
)
```

class: inverse, center, middle

# Introduction

---

### What is an Exoplanet?

- "All of the planets in our solar system orbit around the Sun. Planets that orbit around other stars are called **exoplanets**" - Our friends at NASA.

- Exoplanet discovery allows us to search for habitable planets outside of our solar system!

- As of today, we have discovered over 4500 exoplanets!

<br>
<br>

--
<p align="center">
<img src="https://www.pngkey.com/png/detail/969-9692789_planet-cute-saturn-jupiter-uranus-neptune-smile-cute.png" width="200" height="200" alt="#planet #cute #saturn #jupiter #uranus #neptune #smile - Cute Saturn Clipart@pngkey.com">
</p>

---

class: inverse, center, middle

# Data

---

### NASA Exoplanet Archives Planet Systems Dataset

.pull-left[
- Compilation of system, stellar, and planetary parameters for all known confirmed exoplanets

- Data comes from from many different exoplanet transit survey programs from all around the world (and over the world!)

- Notable programs include the Kepler space mission, the K2 space mission, and the CoRoT space mission 

- Last Updated: April 2021
]

.pull-right[
```{r top-discovery-facilites-tibble, echo = FALSE, include = FALSE}
table <- alldataunfiltered %>%
  count(disc_facility, sort = TRUE) %>%
  top_n(5)
```

```{r top-discovery-facilites-table, echo = FALSE}
  kable(head(table), col.names = c("Discovery Facility", "Discoveries"), caption = "Top 5 Discovery Facilities", format = "html")

```

]

---

### World Bank GDP Per-Capita Dataset

.pull-left[

<iframe src="https://data.worldbank.org/share/widget?end=2020&indicators=NY.GDP.PCAP.CD&start=2020&type=shaded&view=map" width='550' height='366' frameBorder='0' scrolling="no" ></iframe>

]

.pull-right[

- Annual measure of GDP per-capita for every country in the world and some larger regions (eg. European Union)

- GDP per capita measured in USD

- Data from 1960-2020

- We focus on GDP per-capita from 2020

]

---
### Useful Terminology

- **Parsec**: A unit of distance used in astronomy equal to 3.26 light years (3.086 × 1013 kilometers) or the “mean radius of the earth's orbit subtends an angle of one second of arc.” In other words, very far! 

- **GDP Per-Capita**: A country's economic output divided by its total population (indicator of how developed a country is)

- **Earth Radius & Earth Mass**: The radius and mass of an exoplanet is measured relative to Earth's mass and radius (eg. if a planet is twice the mass of Earth, mass = 2)

- **Observatory**: Facility on Earth with telescopes and other technology used in the discovery of exoplanets

- **Space Telescope**: Spacecraft launched into space that floats throughout space discovering exoplanets (eg. Kepler and Hubble)

<p align="center">
<img class="CSS_LIGHTBOX_SCALED_IMAGE_IMG" src="https://3.bp.blogspot.com/-cK5pFMAwvyc/UQ23Fc-g1cI/AAAAAAAAGjQ/cOLdC6cllUE/s1600/Copy+of+telescopemamme.jpg" style="width: 201px; height: 200px;">
</p>
---
### Plotting Facility Locations and Exoplanet Discovery Count


```{r construct-facility_df, echo = FALSE}
facility_df <- alldata %>% 
  group_by(disc_facility, disc_year) %>%
  mutate(count = n()) %>%
  select(disc_facility, disc_facility_country, disc_year, facility_type, facility_latitude, facility_longitude, count) %>%
  distinct() %>%
  filter(!disc_facility == "Multiple Observatories")
```

```{r construct-facility_df2, echo = FALSE}
facility_df2 <- alldataunfiltered %>% 
  group_by(disc_facility) %>%
  mutate(count = n()) %>%
  select(disc_facility, disc_facility_country, facility_type, facility_latitude, facility_longitude,public_or_private, count) %>%
  distinct() %>%
  filter(!disc_facility == "Multiple Observatories") %>%
  filter(!disc_facility == "KOINet") %>%
  filter(!disc_facility == "Multiple Facilities")
```

```{r construct-facility_df_group_by_location, echo = FALSE}
facility_df_lat_group <- alldata %>% 
  group_by(facility_latitude) %>%
  mutate(count = n()) %>%
  select(facility_latitude, facility_longitude, disc_facility, facility_type, count) %>%
  distinct(facility_latitude, .keep_all = TRUE) %>%
  filter(!disc_facility == "Multiple Observatories")
```

```{r construct-facility_df2_group_by_location, echo = FALSE}
facility_df2_lat_group <- alldataunfiltered %>% 
  group_by(facility_latitude) %>%
  mutate(count = n()) %>%
  select(facility_latitude, facility_longitude, disc_facility, facility_type, count) %>%
  distinct(facility_latitude, .keep_all = TRUE) %>%
  filter(!disc_facility == "Multiple Observatories")
```

```{r gdp_country_disc_count, echo = FALSE}
gdp_country_disc_count <- alldataunfiltered %>% 
  group_by(disc_facility_country) %>%
  mutate(count = n()) %>%
  select(disc_facility_country, count, GDP_2020) %>%
  distinct(disc_facility_country, .keep_all = TRUE) %>%
  filter(!disc_facility_country == "Multiple Observatories") %>%
  filter(!disc_facility_country == "Multiple Facilities") %>%
  filter(!disc_facility_country == "KOINet") %>%
  filter(!disc_facility_country == "Europe") 
```

```{r gdp_country_disc_count_no_USA, echo = FALSE}
gdp_country_disc_count_no_USA <- alldataunfiltered %>% 
  group_by(disc_facility_country) %>%
  mutate(count = n()) %>%
  select(disc_facility_country, count, GDP_2020) %>%
  distinct(disc_facility_country, .keep_all = TRUE) %>%
  filter(!disc_facility_country == "Multiple Observatories") %>%
  filter(!disc_facility_country == "Multiple Facilities") %>%
  filter(!disc_facility_country == "United States") %>%
  filter(!disc_facility_country == "KOINet") %>%
  filter(!disc_facility_country == "Europe") 
```

```{r mapping facilities, echo = FALSE, out.width = "100%", fig.align = "top"}

### Group by facility

world_map <- map_data("world")

p <- ggplot() + coord_fixed() +
  xlab("") + ylab("") + labs(title = "Discovery Facilities Mainly Located in Developed Nations",  
                             subtitle = "(Land Obervatories in Red, Space Telescope Launch Sites in Blue)")

base_world_messy <- p + geom_polygon(data = world_map, aes(x = long, y = lat, group = group), 
                               colour ="darkseagreen", fill ="light green")

cleanup <- 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_rect(fill = 'white', colour = 'white'), 
        axis.line = element_line(colour = "white"), legend.position ="none",
        axis.ticks = element_blank(), axis.text.x=element_blank(),
        axis.text.y = element_blank())

base_world <- base_world_messy + cleanup

map_data <- 
  base_world +
  geom_point(data = facility_df2, 
             aes(x = facility_longitude, 
                 y = facility_latitude,
                 size = count,
                 fill = facility_type), 
             colour = "black",
             pch = 21, alpha = I(0.5)) +
             scale_size_continuous(range = c(3, 15))
             
                                   
map_data
```

``` {r mapping-facilities-by-location, include = FALSE}
### Group By Coordinates

world_map <- map_data("world")

p <- ggplot() + coord_fixed() +
  xlab("") + ylab("") 

base_world_messy <- p + geom_polygon(data = world_map, aes(x = long, y = lat, group = group), 
                               colour="darkseagreen", fill="light green")

cleanup <- 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_rect(fill = 'white', colour = 'white'), 
        axis.line = element_line(colour = "white"), legend.position ="none",
        axis.ticks = element_blank(), axis.text.x = element_blank(),
        axis.text.y = element_blank())

base_world <- base_world_messy + cleanup

map_data <- 
  base_world +
  geom_point(data = facility_df_lat_group, 
             aes(x = facility_longitude, y = facility_latitude,size = count,fill = facility_type), colour = "black",
             pch = 21, alpha = I(0.5)) 
map_data
```

---

### Interactive Leaflet Map: Location and Number of Discoveries
```{r discovery-facility-leaflet-labels, echo = FALSE, out.width = "100%"}

labels <- sprintf(
  "<strong>%s</strong><br/>%g Discoveries<br/>Ownership: %s<br/>Ownership Type: %s",
  facility_df2$disc_facility, facility_df2$count, facility_df2$disc_facility_country,facility_df2$public_or_private 
) %>% 
  lapply(htmltools::HTML) 

```

```{r discovery-facility-leaflet, echo = FALSE} 

facility_df2$lat <- jitter(facility_df2$facility_latitude, factor = 0.5)
facility_df2$lon <- jitter(facility_df2$facility_longitude, factor = 0.5)

leaflet(facility_df2) %>%
  setView(lat = -13.7, lng = 13.3, zoom = 2) %>%
      addProviderTiles(providers$Stamen.Terrain) %>%
      addProviderTiles(providers$Stamen.TerrainLabels) %>%
      addMarkers(~lon, ~lat, popup = ~labels)
      
```

---

### Exoplanet Discovery Over Time
```{r disc-distance-over-time-plot, echo = FALSE, warning = FALSE, message = FALSE, results = 'hide', fig.align='center'}

alldataunfiltered %>%
  group_by(disc_year) %>%
  summarise_at(vars(sy_distance), list(name = mean)) %>%
  ggplot(mapping = aes(x = disc_year, y = name)) +
  labs(
    x = "Discovery Year",
    y = "Mean Distance of Discovery (Parsecs)",
    title = "Year to Mean Distance of Discovery (Parsecs)"
  ) +
  geom_point() +
  geom_smooth (color = "black")
  
  
```

---

### Linear Regression of Discovery Year on Mean Distance 

```{r count-on-distance-reg-df, include = FALSE}
disc_distance <- alldataunfiltered %>% 
  group_by(disc_year) %>%
  mutate(count = n()) %>%
  mutate(mean_distance = mean(sy_distance)) %>%
  select(disc_year, count, mean_distance) %>%
  distinct(disc_year, .keep_all = TRUE)
```

``` {r distance-on-time-reg}
distance_on_time_reg <- linear_reg() %>%
  set_engine("lm") %>%
  fit(mean_distance ~ disc_year, data = disc_distance)

tidy(distance_on_time_reg)
glance(distance_on_time_reg)$r.squared
```
<br>

$\widehat{Distance}=\beta_{0}+\beta_{1}Year$

---

### Linear Regression of Discovery Year on Count
``` {r count-on-time-reg}
time_reg <- linear_reg() %>%
  set_engine("lm") %>%
  fit(count ~ disc_year, data = disc_distance)

tidy(time_reg)
glance(time_reg)$r.squared
```
<br>

$\widehat{Count}=\beta_{0}+\beta_{1}Year$

---

### Linear Regression of Mean Distance on Count

```{r count-on-distance-reg}
distance_reg <- linear_reg() %>%
  set_engine("lm") %>%
  fit(count ~ mean_distance, data = disc_distance)

tidy(distance_reg)
glance(distance_reg)$r.squared
```

<br>


$\widehat{Count}=\beta_{0}+\beta_{1}Distance$


---

### Linear Regression of Mean Distance and Discovery Year on Count

``` {r count-on-time-distance-reg}
distance_time_reg <- linear_reg() %>%
  set_engine("lm") %>%
  fit(count ~ mean_distance + disc_year, data = disc_distance)

tidy(distance_time_reg)
glance(distance_time_reg)$r.squared
```
<br>

$\widehat{Count}=\beta_{0}+\beta_{1}Distance+\beta_{2}Year$

---

### Observed Future Trends
- We may discover exoplanets that are further away from us

- We may see an increase in the number of exoplanets discovered

---

### GDP and the Number of Exoplanets Discovered

```{r gdp-vs-count, echo = FALSE, warning = FALSE, message = FALSE, results = 'hide', fig.align = "center"}

# GDP per capita vs count (USA)
gdp_country_disc_count %>%
  ggplot(mapping = aes(
                        x = GDP_2020,
                        y = count,
                        color = disc_facility_country)) +
  geom_jitter() +
  geom_smooth(color = "black") +
  labs(
        x = "2020 GDP Per Capita of Country (USD)",
        y = "Total Discovery Count", 
        title = " Country GDP Per Capita vs Discovery Count") +
  guides(color = guide_legend("Country"))
```
---
### Linear regression on the relationship between GDP and number of discoveres exoplanets 

```{r gdp-vs-count-reg}

# USA Included
gdp_disc <- linear_reg() %>% 
  set_engine("lm") %>%
  fit(count ~ GDP_2020, data = gdp_country_disc_count)

glance(gdp_disc)$r.squared

```

---

### GDP and the number of exoplanets discovered (exluding USA)
```{r gdp-vs-count-without-USA, echo = FALSE, warning = FALSE, message = FALSE, results = 'hide', fig.align = "center"}
# GDP per capita vs count (No USA)
gdp_country_disc_count_no_USA %>%
  ggplot(mapping = aes(
                        x = GDP_2020,
                        y = count,
                        color = disc_facility_country)) +
  geom_jitter() +
  geom_smooth(color = "black") +
  labs(
        x = "2020 GDP Per Capita of Country (USD)",
        y = "Total Discovery Count", 
        title = " Country GDP Per Capita vs Discovery Count") +
  guides(color = guide_legend("Country"))
```

---

### Linear regression on the relationship between GDP and number of discoveres exoplanets (excluding USA)

```{r count-on-gdp-reg-no-us}
# No USA
gdp_disc <- linear_reg() %>% 
  set_engine("lm") %>%
  fit(count ~ GDP_2020, data = gdp_country_disc_count_no_USA)

glance(gdp_disc)$r.squared
```

---

### GDP Per-Capita Discussion

- The United States has the highest GDP per-capita of any of the countries that have discovered exoplants and has the most discoveries by a significant amount

- However, excluding the United States, GDP per-capita does not seem to have a significant impact on the number of exoplanets that a country is able to discover

- All the countries in the sample are wealthly/developed countries

- The United States has the best funded space program by a lot!

---

### Discovery Methods
<FONT COLOR=#728FCE>
- Radial velocity: Measure regular periodic changes in the star’s normal light spectrum which indicates how fast the star is moving directly towards or away from us

<FONT COLOR=magenta>
- Transit: Measure light curve when exoplanets pass in front of their host star and dim its light

<FONT COLOR=green>
- Microlensing: Measure light curve of a distant star that is not physically related to the planet/star

<FONT COLOR=black> 
- Imaging: Directly detect exoplanets using large telescope

- Transit Timing Variations: Observe the variations in the timing of a transit

- Orbital Brightness Modulation: Measure regular, periodic rises in the amount of light that space telescopes receive from the stars


<p align="center">
<img class="J9AiF" src="https://64.media.tumblr.com/fedb2fdb5c89b7d1b4cfdbfb5ac558c6/tumblr_od10f9utK81v8t5gwo1_r1_500.png" alt="#tattoo commission from indigo night">
</p>
---

### Effectiveness of Discovery Methods Over Time
```{r discovery-method-over-time, warning = FALSE, echo = FALSE, fig.align = 'center'}
alldata_discoverymethod <- alldataunfiltered %>%
  filter(!discoverymethod == "Disk Kinematics") %>%
  filter(!discoverymethod == "Pulsar Timing") %>%
  filter(!discoverymethod == "Eclipse Timing Variations") %>%
  filter(!discoverymethod == "Pulsation Timing") %>%
  filter(!discoverymethod == "Pulsation Timing Variations") %>%
  filter(!discoverymethod == "Astrometry")

alldata_discoverymethod %>%
  ggplot(mapping = aes(x = disc_year, fill = fct_relevel(discoverymethod, c("Orbital Brightness Modulation", "Transit Timing Variations", "Microlensing", "Imaging", "Radial Velocity", "Transit")))) +
  geom_bar() + 
  xlim(1997,2021) +
  labs(
        x = "Discovery year",
        y = "Number of exoplanets", 
        fill = "Discovery Method",
        title = "Number of exoplanets discovered per year",
        subtitle = "By discovery method") +
  theme(legend.position = "bottom") +
  theme(legend.key.size = unit(0.4, 'cm')) +
  theme(legend.title = element_blank())

```

---
### Change in Distance of Discovery Over Time by Discovery Method
<p align="center">
  <iframe src="https://dcs-210.github.io/project-matt-annie-ethan/Ethan5.gif" width="1016" height="516" frameBorder="0"></iframe>
</p>

---
### Change in Distance of Discovery Over Time by Discovery Method
```{r animate-scatter, warning = FALSE, echo = FALSE, fig.align = 'center', warning = FALSE}

alldata_dist <- alldataunfiltered %>%
  filter(!sy_distance == 0)

ethan <- ggplot(data = alldata_dist, mapping = aes(y = sy_distance,
                                                   x = disc_year,
                                                   color = discoverymethod)) +
  geom_jitter(alpha = 1) + 
  labs(
        y = "Distance of Discovery (Parsecs)",
        x = "Year", 
        title = "Distance of discovery over time",
        subtitle ="By discovery method" ) +
  theme(legend.position = "bottom") +
  theme(legend.title = element_blank()) +
  theme(legend.key.size = unit(0.2, 'cm')) +
  theme(legend.spacing = unit(0.1, 'cm')) + 
  theme(legend.text = element_text(size=5))

ethan
```

---

### Discovery Methods Discussion

- Prior to 2006, radial velocity is the prominent method of discovery, with a few observations coming from pulsar timing

- Around 2003, microlensing began to be used, allowing us to discover slightly more exoplanets per year, and we were able to discover exoplanets much further from earth

- Around 2006, when transit began to be used, the number of observations per year started to increase rapidly and we were able to discover planets that were a bit further from earth

<p align="center">
<img src="https://th.bing.com/th/id/OIP.qH7G8WkiADoh-P_nv188RAHaFj?pid=ImgDet&amp;rs=1" alt="See the source image" class=" nofocus" tabindex="0" aria-label="See the source image">
</p>

---
### Exoplanets' Radius
```{r discovery-method-vs-planet_radius, echo = FALSE, fig.show = "hold", fig.align = 'center', warning = FALSE}
alldata_discoverymethod <- alldata_discoverymethod %>%
  filter(!pl_name == "HD 100546 b")

alldata_discoverymethod %>%
  ggplot(mapping = aes(x = disc_year,
                       y = pl_radius,
                       color = discoverymethod)) +
  geom_jitter() +
  labs(
        y = "Planet radius [Earth radius]",
        x = "Discovery year", 
        title = "Planet radius and distance of discovery",
        subtitle="By discovery method" ) +
  theme(legend.position = "bottom") +
  theme(legend.title = element_blank()) +
  theme(legend.key.size = unit(0.2, 'cm')) +
  theme(legend.spacing = unit(0.1, 'cm'))
```

---
### Exoplanets' Mass
```{r discovery-method-vs-planet-mass, echo = FALSE, fig.show = "hold", fig.align = 'center', warning = FALSE}
alldata_discoverymethod %>%
  ggplot(mapping = aes(x = disc_year,
                       y = pl_mass,
                       color = discoverymethod), alpha = 0.3) +
  geom_jitter() + 
  labs(
        x = "Discovery year",
        y = "Planet mass [Earth mass]", 
        title = "Planet mass and distance of discovery",
        subtitle="By discovery method" ) +
  theme(legend.position = "bottom") +
  theme(legend.title = element_blank()) +
  theme(legend.key.size = unit(0.2, 'cm')) +
  theme(legend.spacing = unit(0.1, 'cm'))
```

---

### Radius and Mass Discussion

- Around the time that the transit method started being used, we began able to discover exoplanets with smaller radii (likely small solid planets)

- Technology that allows us to discover exoplanets with smaller radii has increased the amount of discoveries per year

- The mass of the exoplanets we have discovered over time has stayed relatively consistent (with a few outliers around 2016)

- Both graphs omit one observation*

.footnote[
[*] Both graphs omit a single exoplanet with an enormous radius and mass: HD 100546 b (Mass = 239000, Radius = 77.342)
]

---

### Conclusion

- Advancements and innovation in the technology used to discover exoplanets appears to be the main driving force in the number of planets discovered each year as well as the parameters of the range of exploration

- The distance of exoplanet discovery has been shown to increase over time, due to advances in technology

- The radii of exoplanets being discovered today has a larger range than it did in the early days of exoplanet exploration (we are now able to discover planets with smaller radii than before)

- The mass of exoplanets being discovered today is consistent with the mass of exoplanets discovered in the early days of exoplanet exploration

- The GDP per-capita of countries with established space programs does not appear to have a significant impact on the amount of exoplanets discovered by different countries, though only developed countries have established space programs

---

### Methods Critique and Areas of Improvement

Change of research direction and recommendation for future research: 
- Initial thought: to predict the number of exoplanet discoveries in the next 5-20 years
- Result: innovations in discovery technology are the largest driver in new exoplanet discovery
- Future research: what steps are currently being made in the space industry to develop new technology

Reliability of the data
- Accurate and correct information reported by NASA
- The data did have a lot of missing values, but they pertained to variables that we did not feel were relevant to our analysis  

Appropriateness of the statistical analysis
- Regression based analyses did not have very high r-squared values, so it is likely that they were either too simple or did not show a significant correlation
- Visual-based analyses appeared to be statistically accurate and representative of other similar literature/publications

---
class: inverse, center, middle

# Questions?

---

