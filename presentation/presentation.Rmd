---
title: "Exoplanet Exploration"
subtitle: "Predicting Future Trends in Exoplanet Exploration"
author: "Annie Li, Matt Clayton, Ethan Wu"
institute: "Bates College"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
library(xaringan)
library(dplyr)
library(maps)
library(ggplot2)
library(gganimate)
library(gifski)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r load-data, include=FALSE}
alldata <- read_csv("/cloud/project/data/filtereddata.csv")
alldataunfiltered <- read_csv("/cloud/project/data/unfiltereddata.csv")
```

```{r discovery-facility-country, include=FALSE}
# Create new variable for country of discovery facility

### Facility Country for filtered data

alldata %>%
  count(disc_facility, sort = TRUE)

alldata <- alldata %>%
  
  mutate(disc_facility = as.character(disc_facility),
         disc_facility_country = case_when(
                                 disc_facility %in% c("Kepler",
                                                       "K2",
                                                       "Transiting Exoplanet Survey Satellite (TESS)",
                                                       "HATNet",
                                                       "HATSouth",
                                                       "W. M. Keck Observatory",
                                                       "XO",
                                                       "KELT-North",
                                                       "KELT",
                                                       "TrES",
                                                       "Acton Sky Portal Observatory",
                                                       "Gemini Observatory",
                                                       "KELT-South",
                                                       "Las Campanas Observatory",
                                                       "MEarth Project",
                                                       "Cerro Tololo Inter-American Observatory",
                                                       "Fred Lawrence Whipple Observatory",
                                                       "Lick Observatory",
                                                       "McDonald Observatory")
                                                        ~ "United States",
                                 disc_facility %in% c("La Silla Observatory",
                                                       "Paranal Observatory",
                                                       "CoRoT")
                                                        ~ "Europe",
                                 disc_facility %in% c("SuperWASP",
                                                       "WASP-South",
                                                       "SuperWASP-North",
                                                       "SuperWASP-South",
                                                       "United Kingdom Infrared Telescope")
                                                       ~ "United Kingdom",
                                 disc_facility %in% c("Roque de los Muchachos Observatory",
                                                       "Calar Alto Observatory")
                                                       ~ "Spain",
                                 disc_facility == "Haute-Provence Observatory" ~ "France",
                                 disc_facility == "Qatar" ~ "Qatar",
                                 disc_facility == "OGLE" ~ "Poland",
                                 disc_facility == "Subaru Telescope" ~ "Japan",
                                 TRUE ~ disc_facility
  )) 

### Facility Country for unfiltered data

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         disc_facility_country = case_when(
                                 disc_facility %in% c("Kepler",
                                                       "K2",
                                                       "Transiting Exoplanet Survey Satellite (TESS)",
                                                       "HATNet",
                                                       "HATSouth",
                                                       "W. M. Keck Observatory",
                                                       "XO",
                                                       "KELT-North",
                                                       "KELT",
                                                       "TrES",
                                                       "Acton Sky Portal Observatory",
                                                       "Gemini Observatory",
                                                       "KELT-South",
                                                       "Las Campanas Observatory",
                                                       "MEarth Project",
                                                       "Cerro Tololo Inter-American Observatory",
                                                       "Fred Lawrence Whipple Observatory",
                                                       "Lick Observatory",
                                                       "McDonald Observatory",
                                                       "Hubble Space Telescope",
                                                       "NASA Infrared Telescope Facility (IRTF)",
                                                       "Spitzer Space Telescope",
                                                       "Palomar Observatory",
                                                       "Kitt Peak National Observatory",
                                                       "Oak Ridge Observatory",
                                                       "Apache Point Observatory",
                                                       "Large Binocular Telescope Observatory",
                                                       "Winer Observatory",
                                                       "Arecibo Observatory",
                                                       "Leoncito Astronomical Complex",
                                                       "Mauna Kea Observatory",
                                                       "Haleakala Observatory")
                                                        ~ "United States",
                                 disc_facility %in% c("La Silla Observatory",
                                                       "Paranal Observatory",
                                                       "CoRoT",
                                                       "CHaracterising ExOPlanets Satellite (CHEOPS)",
                                                       "Atacama Large Millimeter Array (ALMA)",
                                                       "European Southern Observatory")
                                                        ~ "Europe",
                                 disc_facility %in% c("SuperWASP",
                                                       "WASP-South",
                                                       "SuperWASP-North",
                                                       "SuperWASP-South",
                                                       "United Kingdom Infrared Telescope",
                                                       "Infrared Survey Facility")
                                                       ~ "United Kingdom",
                                 disc_facility %in% c("Roque de los Muchachos Observatory",
                                                       "Calar Alto Observatory",
                                                       "Teide Observatory")
                                                       ~ "Spain",
                                 disc_facility %in% c("Xinglong Station", 
                                                      "Yunnan Astronomical Observatory")
                                                      ~ "China",
                                 disc_facility %in% c("Subaru Telescope",
                                                      "Okayama Astrophysical Observatory")
                                                      ~ "Japan",
                                 disc_facility %in% c("Anglo-Australian Telescope",
                                                      "Parkes Observatory")
                                                      ~ "Australia",
                                 disc_facility %in% c("KMTNet",
                                                      "Bohyunsan Optical Astronomical Observatory")
                                                      ~ "South Korea",
                                 disc_facility == "MOA" ~ "New Zealand",
                                 disc_facility == "Haute-Provence Observatory" ~ "France",
                                 disc_facility == "Qatar" ~ "Qatar",
                                 disc_facility == "OGLE" ~ "Poland",
                                 disc_facility == "Thueringer Landessternwarte Tautenburg" ~ "Germany",
                                 
                                 TRUE ~ disc_facility
  ))

```

```{r public-or-private, include=FALSE}

### Public or private for filtered data

alldata <- alldata %>%
  
  mutate(disc_facility = as.character(disc_facility),
         public_or_private = ifelse( disc_facility %in% c("KELT-North",
                                                          "KELT",
                                                          "Fred Lawrence Whipple Observatory",
                                                          "McDonald Observatory",
                                                          "Acton Sky Portal Observatory",
                                                          "KELT-South"), "Private", "Public"))

### Public or private for unfiltered data

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         public_or_private = ifelse( disc_facility %in% c("KELT-North",
                                                          "KELT",
                                                          "Fred Lawrence Whipple Observatory",
                                                          "McDonald Observatory",
                                                          "Acton Sky Portal Observatory",
                                                          "KELT-South",
                                                          "Palomar Observatory",
                                                          "Oak Ridge Observatory",
                                                          "KMTNet",
                                                          "Large Binocular Telescope Observatory",
                                                          "Winer Observatory"), "Private", "Public"))
```

```{r telescope-type, include=FALSE}

### Facility Type for filtered data

alldata <- alldata %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_type = ifelse( disc_facility %in% c("CoRoT",
                                                      "Kepler",
                                                      "K2",
                                                      "Transiting Exoplanet Survey Satellite (TESS)"),
                                                         "Space Telescope",
                                                         "Observatory"))
  
### Facility Type for unfiltered data

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_type = ifelse( disc_facility %in% c("CoRoT",
                                                      "Kepler",
                                                      "K2",
                                                      "Transiting Exoplanet Survey Satellite (TESS)",
                                                      "Hubble Space Telescope",
                                                      "Spitzer Space Telescope",
                                                      "CHaracterising ExOPlanets Satellite (CHEOPS)"),
                                                         "Space Telescope",
                                                         "Observatory"))
```

```{r facility-latitude, include=FALSE}

### Latitude for filtered data

alldata <- alldata %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_latitude = case_when(
                                 disc_facility == "HATNet" ~ 31.674920,
                                 disc_facility == "HATSouth" ~ -29.014600,
                                 disc_facility == "W. M. Keck Observatory" ~ 19.826360,
                                 disc_facility == "XO" ~ 20.708300,
                                 disc_facility == "TrES" ~ 35.1210,
                                 disc_facility == "Gemini Observatory" ~ 19.823960,
                                 disc_facility == "Las Campanas Observatory" ~ -29.014600,
                                 disc_facility == "MEarth Project" ~ 31.674920,
                                 disc_facility == "Cerro Tololo Inter-American Observatory" ~ -30.169660,
                                 disc_facility == "Lick Observatory" ~ 37.341373,
                                 disc_facility == "La Silla Observatory" ~ -29.261170,
                                 disc_facility == "Paranal Observatory" ~ -24.627220,
                                 disc_facility == "SuperWASP" ~ 28.4537,
                                 disc_facility == "WASP-South" ~ -26.030260,
                                 disc_facility == "SuperWASP-North" ~ 28.75651,
                                 disc_facility == "SuperWASP-South" ~ -26.030260,
                                 disc_facility == "United Kingdom Infrared Telescope" ~ 19.822500,
                                 disc_facility == "Roque de los Muchachos Observatory" ~ 28.4522,
                                 disc_facility == "Calar Alto Observatory" ~ 37.220790,
                                 disc_facility == "Haute-Provence Observatory" ~ 43.930830, 
                                 disc_facility == "Qatar" ~ 32.902359,
                                 disc_facility == "OGLE" ~ -29.0036,
                                 disc_facility == "Subaru Telescope" ~ 19.701610,
                                 disc_facility == "KELT-North" ~ 31.71272,
                                 disc_facility == "KELT" ~ 31.71272,
                                 disc_facility == "Fred Lawrence Whipple Observatory" ~ 31.674920,
                                 disc_facility == "McDonald Observatory" ~ 30.679770,
                                 disc_facility == "Acton Sky Portal Observatory" ~ 42.477587,
                                 disc_facility == "KELT-South" ~ 31.71272,
                                 disc_facility == "CoRoT" ~ 45.592759,
                                 disc_facility == "Kepler" ~ 28.446671,
                                 disc_facility == "K2" ~ 28.446671,
                                 disc_facility == "Transiting Exoplanet Survey Satellite (TESS)" ~ 28.562110,
                                 
                                                     
                                 TRUE ~ 0
  ))

### Latitude for unfiltered data

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_latitude = case_when(
                                 disc_facility == "HATNet" ~ 31.674920,
                                 disc_facility == "HATSouth" ~ -29.014600,
                                 disc_facility == "W. M. Keck Observatory" ~ 19.826360,
                                 disc_facility == "XO" ~ 20.708300,
                                 disc_facility == "TrES" ~ 35.1210,
                                 disc_facility == "Gemini Observatory" ~ 19.823960,
                                 disc_facility == "Las Campanas Observatory" ~ -29.014600,
                                 disc_facility == "MEarth Project" ~ 31.674920,
                                 disc_facility == "Cerro Tololo Inter-American Observatory" ~ -30.169660,
                                 disc_facility == "Lick Observatory" ~ 37.341373,
                                 disc_facility == "La Silla Observatory" ~ -29.261170,
                                 disc_facility == "Paranal Observatory" ~ -24.627220,
                                 disc_facility == "SuperWASP" ~ 28.4537,
                                 disc_facility == "WASP-South" ~ -26.030260,
                                 disc_facility == "SuperWASP-North" ~ 28.75651,
                                 disc_facility == "SuperWASP-South" ~ -26.030260,
                                 disc_facility == "United Kingdom Infrared Telescope" ~ 19.822500,
                                 disc_facility == "Roque de los Muchachos Observatory" ~ 28.4522,
                                 disc_facility == "Calar Alto Observatory" ~ 37.220790,
                                 disc_facility == "Haute-Provence Observatory" ~ 43.930830, 
                                 disc_facility == "Qatar" ~ 32.902359,
                                 disc_facility == "OGLE" ~ -29.0036,
                                 disc_facility == "Subaru Telescope" ~ 19.701610,
                                 disc_facility == "KELT-North" ~ 31.71272,
                                 disc_facility == "KELT" ~ 31.71272,
                                 disc_facility == "Fred Lawrence Whipple Observatory" ~ 31.674920,
                                 disc_facility == "McDonald Observatory" ~ 30.679770,
                                 disc_facility == "Acton Sky Portal Observatory" ~ 42.477587,
                                 disc_facility == "KELT-South" ~ 31.71272,
                                 disc_facility == "CoRoT" ~ 45.592759,
                                 disc_facility == "Kepler" ~ 28.446671,
                                 disc_facility == "K2" ~ 28.446671,
                                 disc_facility == "Transiting Exoplanet Survey Satellite (TESS)" ~ 28.562110,
                                 disc_facility == "Xinglong Station" ~ 40.394170,
                                 disc_facility == "Thueringer Landessternwarte Tautenburg" ~ 50.982190,
                                 disc_facility == "Okayama Astrophysical Observatory" ~ 34.576100,
                                 disc_facility == "Hubble Space Telescope" ~ 28.608400,
                                 disc_facility == "Anglo-Australian Telescope" ~ -31.275400,
                                 disc_facility == "Bohyunsan Optical Astronomical Observatory" ~ 36.160774,
                                 disc_facility == "NASA Infrared Telescope Facility (IRTF)" ~ 19.826210,
                                 disc_facility == "Yunnan Astronomical Observatory" ~ 25.033330, 
                                 disc_facility == "Spitzer Space Telescope" ~ 28.446671,
                                 disc_facility == "Kitt Peak National Observatory" ~ 31.960050,
                                 disc_facility == "CHaracterising ExOPlanets Satellite (CHEOPS)" ~ 5.301861,
                                 disc_facility == "Apache Point Observatory" ~ 32.780340,
                                 disc_facility == "Atacama Large Millimeter Array (ALMA)" ~ -23.027780,
                                 disc_facility == "MOA" ~ -43.970600,
                                 disc_facility == "European Southern Observatory" ~ 48.260000,
                                 disc_facility == "Arecibo Observatory" ~ 18.344168,
                                 disc_facility == "Parkes Observatory" ~ -33.011640,
                                 disc_facility == "Leoncito Astronomical Complex" ~ -31.798600,
                                 disc_facility == "Infrared Survey Facility" ~ 19.822500,
                                 disc_facility == "Mauna Kea Observatory" ~ 19.4920,
                                 disc_facility == "Teide Observatory" ~ 28.1800,
                                 disc_facility == "Haleakala Observatory" ~ 20.4230,
                                 disc_facility == "Palomar Observatory" ~ 33.357030,
                                 disc_facility == "Oak Ridge Observatory" ~ 42.505000,
                                 disc_facility == "KMTNet" ~ -31.16163,
                                 disc_facility == "Large Binocular Telescope Observatory" ~ 32.701310,
                                 disc_facility == "Winer Observatory" ~ 31.665947,
                                 
                                 TRUE ~ 0
  ))

```

```{r facility-longitude, include=FALSE}

### Longitude for filtered data

alldata <- alldata %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_longitude = case_when(
                                 disc_facility == "HATNet" ~ -110.949600,
                                 disc_facility == "HATSouth" ~ -70.692600,
                                 disc_facility == "W. M. Keck Observatory" ~ -155.475000,
                                 disc_facility == "XO" ~ -156.257100,
                                 disc_facility == "TrES" ~ -111.3952,
                                 disc_facility == "Gemini Observatory" ~ -155.469800,
                                 disc_facility == "Las Campanas Observatory" ~ -70.692600,
                                 disc_facility == "MEarth Project" ~ -110.949600,
                                 disc_facility == "Cerro Tololo Inter-American Observatory" ~ -70.806530,
                                 disc_facility == "Lick Observatory" ~ -121.642944,
                                 disc_facility == "La Silla Observatory" ~ -70.731330,
                                 disc_facility == "Paranal Observatory" ~ -70.404170,
                                 disc_facility == "SuperWASP" ~ -17.5245,
                                 disc_facility == "WASP-South" ~ 27.924900,
                                 disc_facility == "SuperWASP-North" ~ -17.89163,
                                 disc_facility == "SuperWASP-South" ~ 27.924900,
                                 disc_facility == "United Kingdom Infrared Telescope" ~ -155.470700,
                                 disc_facility == "Roque de los Muchachos Observatory" ~ -17.5330,
                                 disc_facility == "Calar Alto Observatory" ~ -2.546575,
                                 disc_facility == "Haute-Provence Observatory" ~ 5.713333, 
                                 disc_facility == "Qatar" ~ -105.530205,
                                 disc_facility == "OGLE" ~ -70.4156,
                                 disc_facility == "Subaru Telescope" ~ -155.089600,
                                 disc_facility == "KELT-North" ~ -110.60182,
                                 disc_facility == "KELT" ~ -110.60182,
                                 disc_facility == "Fred Lawrence Whipple Observatory" ~ -110.949600,
                                 disc_facility == "McDonald Observatory" ~ -104.024800,
                                 disc_facility == "Acton Sky Portal Observatory" ~ -71.453447,
                                 disc_facility == "KELT-South" ~ -110.60182,
                                 disc_facility == "CoRoT" ~ 63.333059,
                                 disc_facility == "Kepler" ~ -80.566109,
                                 disc_facility == "K2" ~ -80.566109,
                                 disc_facility == "Transiting Exoplanet Survey Satellite (TESS)" ~ -80.577180,
                                                     
                                 TRUE ~ 0
  ))

### Longitude for unfiltered data

alldataunfiltered <- alldataunfiltered %>%
  
  mutate(disc_facility = as.character(disc_facility),
         facility_longitude = case_when(
                                 disc_facility == "HATNet" ~ -110.949600,
                                 disc_facility == "HATSouth" ~ -70.692600,
                                 disc_facility == "W. M. Keck Observatory" ~ -155.475000,
                                 disc_facility == "XO" ~ -156.257100,
                                 disc_facility == "TrES" ~ -111.3952,
                                 disc_facility == "Gemini Observatory" ~ -155.469800,
                                 disc_facility == "Las Campanas Observatory" ~ -70.692600,
                                 disc_facility == "MEarth Project" ~ -110.949600,
                                 disc_facility == "Cerro Tololo Inter-American Observatory" ~ -70.806530,
                                 disc_facility == "Lick Observatory" ~ -121.642944,
                                 disc_facility == "La Silla Observatory" ~ -70.731330,
                                 disc_facility == "Paranal Observatory" ~ -70.404170,
                                 disc_facility == "SuperWASP" ~ -17.5245,
                                 disc_facility == "WASP-South" ~ 27.924900,
                                 disc_facility == "SuperWASP-North" ~ -17.89163,
                                 disc_facility == "SuperWASP-South" ~ 27.924900,
                                 disc_facility == "United Kingdom Infrared Telescope" ~ -155.470700,
                                 disc_facility == "Roque de los Muchachos Observatory" ~ -17.5330,
                                 disc_facility == "Calar Alto Observatory" ~ -2.546575,
                                 disc_facility == "Haute-Provence Observatory" ~ 5.713333, 
                                 disc_facility == "Qatar" ~ -105.530205,
                                 disc_facility == "OGLE" ~ -70.4156,
                                 disc_facility == "Subaru Telescope" ~ -155.089600,
                                 disc_facility == "KELT-North" ~ -110.60182,
                                 disc_facility == "KELT" ~ -110.60182,
                                 disc_facility == "Fred Lawrence Whipple Observatory" ~ -110.949600,
                                 disc_facility == "McDonald Observatory" ~ -104.024800,
                                 disc_facility == "Acton Sky Portal Observatory" ~ -71.453447,
                                 disc_facility == "KELT-South" ~ -110.60182,
                                 disc_facility == "CoRoT" ~ 63.333059,
                                 disc_facility == "Kepler" ~ -80.566109,
                                 disc_facility == "K2" ~ -80.566109,
                                 disc_facility == "Transiting Exoplanet Survey Satellite (TESS)" ~ -80.577180, 
                                 disc_facility == "Xinglong Station" ~ 117.575000,
                                 disc_facility == "Thueringer Landessternwarte Tautenburg" ~ 11.710900,
                                 disc_facility == "Okayama Astrophysical Observatory" ~ 133.594000,
                                 disc_facility == "Hubble Space Telescope" ~ -80.604350,
                                 disc_facility == "Anglo-Australian Telescope" ~ 149.067200,
                                 disc_facility == "Bohyunsan Optical Astronomical Observatory" ~ 128.973770,
                                 disc_facility == "NASA Infrared Telescope Facility (IRTF)" ~ -155.472600,
                                 disc_facility == "Yunnan Astronomical Observatory" ~ 102.783300, 
                                 disc_facility == "Spitzer Space Telescope" ~ -80.566109,
                                 disc_facility == "Kitt Peak National Observatory" ~ -111.598000,
                                 disc_facility == "CHaracterising ExOPlanets Satellite (CHEOPS)" ~ -52.834583,
                                 disc_facility == "Apache Point Observatory" ~ -105.819800,
                                 disc_facility == "Atacama Large Millimeter Array (ALMA)" ~ -67.754810,
                                 disc_facility == "MOA" ~ 170.467133,
                                 disc_facility == "European Southern Observatory" ~ 11.671110,
                                 disc_facility == "Arecibo Observatory" ~ -66.752777,
                                 disc_facility == "Parkes Observatory" ~ 148.258200,
                                 disc_facility == "Leoncito Astronomical Complex" ~ -69.295600,
                                 disc_facility == "Infrared Survey Facility" ~ -155.470700,
                                 disc_facility == "Mauna Kea Observatory" ~ -155.2830,
                                 disc_facility == "Teide Observatory" ~ -16.3035,
                                 disc_facility == "Haleakala Observatory" ~ -156.1526,
                                 disc_facility == "Palomar Observatory" ~ -116.865300,
                                 disc_facility == "Oak Ridge Observatory" ~ -71.558000,
                                 disc_facility == "KMTNet" ~ 149.03452,
                                 disc_facility == "Large Binocular Telescope Observatory" ~ -109.889100,
                                 disc_facility == "Winer Observatory" ~ -110.602058,
                                 
                                 TRUE ~ 0
  ))

```


```{r}
style_xaringan(
  title_slide_background_image = "img/SPACE_2.jpg"
)
```

---

### Plotting facilities and discoveries
```{r construct-facility_df, echo=FALSE}
facility_df <- alldata %>% 
  group_by(disc_facility, disc_year) %>%
  mutate(count = n()) %>%
  select(disc_facility, disc_year, facility_type, facility_latitude, facility_longitude, count) %>%
  distinct() %>%
  filter(!disc_facility == "Multiple Observatories")
```

```{r construct-facility_df2, echo=FALSE}
facility_df2 <- alldataunfiltered %>% 
  group_by(disc_facility) %>%
  mutate(count = n()) %>%
  select(disc_facility, facility_type, facility_latitude, facility_longitude, count) %>%
  distinct() %>%
  filter(!disc_facility == "Multiple Observatories") %>%
  filter(!disc_facility == "KOINet")
```

```{r construct-facility_df_group_by_location, echo=FALSE}
facility_df_lat_group <- alldata %>% 
  group_by(facility_latitude) %>%
  mutate(count = n()) %>%
  select(facility_latitude, facility_longitude, disc_facility, facility_type, count) %>%
  distinct(facility_latitude, .keep_all = TRUE) %>%
  filter(!disc_facility == "Multiple Observatories")
```

```{r construct-facility_df2_group_by_location}
facility_df2_lat_group <- alldataunfiltered %>% 
  group_by(facility_latitude) %>%
  mutate(count = n()) %>%
  select(facility_latitude, facility_longitude, disc_facility, facility_type, count) %>%
  distinct(facility_latitude, .keep_all = TRUE) %>%
  filter(!disc_facility == "Multiple Observatories")
```


```{r mapping facilities, echo=FALSE, out.width = "500%", fig.align = "center"}

### Group by facility

world_map <- map_data("world")

p <- ggplot() + coord_fixed() +
  xlab("") + ylab("")

base_world_messy <- p + geom_polygon(data=world_map, aes(x=long, y=lat, group=group), 
                               colour="darkseagreen", fill="light green")

cleanup <- 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_rect(fill = 'white', colour = 'white'), 
        axis.line = element_line(colour = "white"), legend.position="none",
        axis.ticks=element_blank(), axis.text.x=element_blank(),
        axis.text.y=element_blank())

base_world <- base_world_messy + cleanup

map_data <- 
  base_world +
  geom_point(data=facility_df, 
             aes(x=facility_longitude, y=facility_latitude,size = count,fill=facility_type), colour = "black",
             pch=21, alpha=I(0.5))
map_data

### Group By Coordinates

world_map <- map_data("world")

p <- ggplot() + coord_fixed() +
  xlab("") + ylab("")

base_world_messy <- p + geom_polygon(data=world_map, aes(x=long, y=lat, group=group), 
                               colour="darkseagreen", fill="light green")

cleanup <- 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), 
        panel.background = element_rect(fill = 'white', colour = 'white'), 
        axis.line = element_line(colour = "white"), legend.position="none",
        axis.ticks=element_blank(), axis.text.x=element_blank(),
        axis.text.y=element_blank())

base_world <- base_world_messy + cleanup

map_data <- 
  base_world +
  geom_point(data=facility_df_lat_group, 
             aes(x=facility_longitude, y=facility_latitude,size = count,fill=facility_type), colour = "black",
             pch=21, alpha=I(0.5))
map_data
```



---

class: center, middle

## A statement of the overall goal / research question

---

class: inverse, center, middle

# Section title

---

# Hello World

- Click the `Knit` button to compile your presentation

- Make sure to commit and push all resulting files to your GitHub repo

---

class: inverse, middle, center

# Using xaringan

---

# xaringan

- The presentation is created using the `xaringan` package

- Use `---` to separate slides and `--` for incremental builds

--

- Like this

---

# Layouts

You can use plain text

- or bullet points

.pull-left[
or text in two columns $^*$
]
.pull-right[
- like
- this
]

.footnote[
[*] And add footnotes
]

---

# Code

```{r boring-regression}
# a boring regression
model <- lm(dist ~ speed, data = cars)
tidy(model)
glance(model)
```

---

# Plots

```{r recode-species, echo = FALSE}
# In this chunk I'm doing a bunch of analysis that I don't want to present 
# in my slides. But I need the resulting data frame for a plot I want to present.
iris_modified <- iris %>%
  mutate(Species = fct_other(Species, keep = "setosa"))
```

```{r plot-iris, echo = FALSE}
# Code hidden with echo = FALSE
# Uses modified iris dataset from previous chunk
# Play around with height and width until you're happy with the look
# ggplot(data = iris_modified, mapping = aes(x = Sepal.Width, y = Sepal.Length, color = Species)) +
#  geom_point() + 
#  theme_minimal() # theme options: https://ggplot2.tidyverse.org/reference/ggtheme.html
```

```{r discovery-method-over-time, echo = FALSE}
alldata %>%
  ggplot(mapping = aes(x = disc_year, fill = fct_relevel(discoverymethod, c( "Orbital Brightness Modulation", "Transit Timing Variations", "Imaging", "Radial Velocity", "Transit")))) +
  geom_bar() +
  labs(
        x = "Discovery year",
        y = "Number of exoplanets", 
        fill = "Discovery Method",
        title = "Number of exoplanets discovered per year",
        subtitle="By discovery method") 
```

---
# Plots
```{r discovery-method-vs-planet_radius-and-planet-mass, echo = FALSE, fig.show="hold", out.width="50%"}
alldata %>%
  ggplot(mapping = aes(x = pl_radius,
                       y = sy_distance,
                       color = discoverymethod)) +
  geom_jitter() +
  coord_flip() +
  labs(
        x = "Distance of Discovery (Parsecs)",
        y = "Planet radius [Earth radius]", 
        title = "Planet radius and distance of discovery",
        subtitle="By discovery method" ) +
  theme(legend.position = "bottom") +
  theme(legend.title = element_blank())

alldata %>%
  ggplot(mapping = aes(y = pl_mass,
                       x = sy_distance,
                       color = discoverymethod), alpha = 0.3) +
  geom_jitter() + 
  coord_flip() +
  labs(
        y = "Distance of Discovery (Parsecs)",
        x = "Planet mass [Earth mass]", 
        title = "Planet mass and distance of discovery",
        subtitle="By discovery method" ) +
  theme(legend.position = "bottom") +
  theme(legend.title = element_blank())
```
--- 

--- 

```{r animate-scatter, echo = FALSE, fig.show="hold", out.width="50%"}
ethan <- ggplot(data = alldata, mapping = aes(y = sy_distance,
                       x = disc_year,
                       color = discoverymethod,
                       size = pl_mass)) +
           
           
  geom_jitter(alpha = 1) + 
  labs(
        y = "Distance of Discovery (Parsecs)",
        x = "Planet mass [Earth mass]", 
        title = "Planet mass and distance of discovery",
        subtitle="By discovery method" ) +
  theme(legend.position = "bottom") +
  theme(legend.title = element_blank()) 

ethan + transition_reveal(disc_year)
```

---

## Plot and text

.pull-left[
- Some text
- goes here
]
.pull-right[
```{r warning=FALSE, out.width="100%", fig.width=4, echo=FALSE}
# see how I changed out.width and fig.width from defaults
# to make the figure bigger
ggplot(penguins, aes(x = bill_length_mm, y = species, color = species)) +
  geom_boxplot() +
  theme_minimal()
```
]

---

# Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r iris-table, echo = FALSE}
kable(head(iris), format = "html")
```

---

# Images

```{r castle, echo = FALSE, out.width = "60%", fig.align = "center", fig.cap = "Image credit: Photo by Jörg Angeli on Unsplash."}
include_graphics("https://images.unsplash.com/photo-1535448033526-c0e85c9e6968?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80")
```

Or you can also include a full page image. See next slide.

---

background-image: url(https://images.unsplash.com/photo-1535448033526-c0e85c9e6968?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1650&q=80)

---

# Math Expressions

You can write LaTeX math expressions inside a pair of dollar signs, e.g. &#36;\alpha+\beta$ renders $\alpha+\beta$. You can use the display style with double dollar signs:

```
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$

Limitations:

1. The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

1. There should not be spaces after the opening `$` or before the closing `$`.

1. Math does not work on the title slide (see [#61](https://github.com/yihui/xaringan/issues/61) for a workaround).

---

# Feeling adventurous?

- Want to find out more about `xaringan`? See https://slides.yihui.name/xaringan/#1.

- You are welcomed to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

- But some of you might want to play around with slide styling. The 
`xaringanthemer` provides some solutions for this that: https://pkg.garrickadenbuie.com/xaringanthemer.

- And if you want more bells and whistles, there is also `xaringanExtra`: https://pkg.garrickadenbuie.com/xaringanExtra.
